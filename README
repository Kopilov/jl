
./stat.pl --help
отказ от отвественности: автор данной программы не несет никакой ответственности в связи с ее использованием ни перед кем

1. забрать лог транзакций
    тут https://jetlend.ru/invest/v3/notifications внизу зеленая кнопка 'Экспорт операций', жать, сохранить себе файл transactions.xlsx

2. скормить полученный файл этому скрипту
    ./stat.pl --xlsx c:/path/to/transactions.xlsx

3. если неосиливается парс екзеля, можно через csv:
    конвертировать полученный файл в .csv, например открыть его в екзеле и сохранить в формате .csv
    разделитель полей - запятая
    без квотирования значений
    и надо чтобы разделитель целой/дробной части в числах был точка

    затем таки скормить полученный файл этому скрипту
        ./stat.pl --csv c:/path/to/transactions.csv

4. смотерть результат
    взять комплектный шаблон отсюда https://github.com/vopl/jl/raw/main/stat.xlsx
    скопипастить в него выхлоп скрипта, внимательно проследить чтобы при копипасте не нарушилась табличная структура данных, чтобы все чиселки попали в такие же на шаблоне
    наблюдать графики, легенда:
        семантика
            cpy - Current Percentage Yield, доход кумулятивно в процентах
            apy - Annual Percentage Yield, доходность годовых
            irr - Internal Rate of Return, это то что все считают по функции XIRR, практически то же самое что 'apy' (не будет работать если не обеспечить соответствующий перловый модуль)

        суффиксы для окон
            7     - значение взято по скользящему окну размером в неделю
            30    - в месяц
            91    - в квартал
            пусто - без окон, просто за за весь доступный период

        суффиксы для типов доходностей
            _i    - инвестиционная часть доходности
            _s    - спекулятивная (в связи с операциями на вторичке по ценам отличным от 100%)
            _o    - остальная (тут например бонусы)
            пусто - это суммарно все вышеперечисленные типы

замечания можно сливать на гитхаб в раздел issues тут https://github.com/vopl/jl/issues (автор НЕ гарантирует что будет их отрабатывать)

лицензия WTFPL (public domain)

--------------------------------------------------
далее хроника запуска на виндоусе
ставить перл
    https://strawberryperl.com/releases.html
    PDL edition, на тот момент это было https://github.com/StrawberryPerl/Perl-Dist-Strawberry/releases/download/SP_5380_5361/strawberry-perl-5.38.0.1-64bit-PDL.zip
    распаковать в c:\perl64

добавить в переменную окружения PATH пару путей на инфраструктуру к перлу, в моем случае это
    C:\perl64\perl\bin
    C:\perl64\c\bin
    (правой мышью на кнопке пуск, Система, Дополнительные параметры системы, кнопка Переменные среды, переменная Path, добавляенм пару значений)

добавить к перлу необходимые модули
    в консоли выполняем такую команду
    cpan install Finance::Math::IRR

екзель?
    екзель я не осилил как установить, офис360 везде, наверное это оно и есть, но оно хочет денег, в общем плюнул
    беру libreoffice отсюда 
        https://www.libreoffice.org/download/download-libreoffice/
        https://download.documentfoundation.org/libreoffice/stable/7.6.4/win/x86_64/LibreOffice_7.6.4_Win_x86-64.msi.mirrorlist
        https://mirror.truenetwork.ru/tdf/libreoffice/stable/7.6.4/win/x86_64/LibreOffice_7.6.4_Win_x86-64.msi

забрать скрипт и шаблон отсюда
    https://github.com/vopl/jl/raw/main/stat.pl
    https://github.com/vopl/jl/raw/main/stat.xlsx
    сохраняем куда нибудь

забрать лог транзакций
    с сайта джетленда забрать файл transactions.xlsx, сохранить туда же

запускаем в консоли
    perl stat.pl --xlsx transactions.xlsx > yield.csv

смотрим
    файл yield.csv открываем текстовым редактором или самим екзелем, копируем из него данные в буфер обмена
    офисом открываем stat.xlsx и вставляем в него скопированные данные, 
    при вставке внимательно смотрим чтобы табличная структура не попортилась, по необходимости конфигурируем параметры вставки
    наблюдаем графики
